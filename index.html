<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>SHEFO Store | Ø¨Ø±Ø§Ù†Ø¯ Ø´ÙŠÙÙˆ</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;500;700;900&display=swap" rel="stylesheet">

<style>
/* --- Ù†ÙØ³ Ø§Ù„ØªØµÙ…ÙŠÙ… --- */
:root { --bg-main: #020617; --bg-surface: #0f172a; --primary: #d97706; --primary-glow: #fbbf24; --text: #f1f5f9; --border: #1e293b; --success: #10b981; --danger: #ef4444; }
* {box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent;}
body { margin: 0; font-family: 'Tajawal', sans-serif; background: var(--bg-main); color: var(--text); padding-bottom: 0; overflow-x: hidden; }

/* Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
.splash-screen { position: fixed; inset: 0; background: #000; z-index: 9999; display: flex; justify-content: center; align-items: center; flex-direction: column; transition: opacity 0.5s ease-out; }
.splash-logo { font-size: 3rem; font-weight: 900; background: linear-gradient(45deg, var(--primary), var(--primary-glow)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; animation: pulseLogo 1.5s infinite alternate; }
.loader-bar { width: 150px; height: 4px; background: #1e293b; margin-top: 20px; border-radius: 2px; overflow: hidden; }
.loader-progress { width: 0%; height: 100%; background: var(--primary); animation: loadProgress 2s ease-in-out forwards; }
@keyframes pulseLogo { from{transform:scale(1); opacity:0.8;} to{transform:scale(1.1); opacity:1;} }
@keyframes loadProgress { 0%{width:0%} 100%{width:100%} }

/* Ø§Ù„Ø´Ø±ÙŠØ· */
.top-ticker { background: linear-gradient(90deg, #b45309, #d97706); color: white; font-size: 0.85rem; padding: 6px 0; overflow: hidden; white-space: nowrap; position: relative; z-index: 101; }
.ticker-text { display: inline-block; animation: scrollText 20s linear infinite; padding-left: 100%; font-weight: bold; letter-spacing: 0.5px; }
@keyframes scrollText { 0% { transform: translateX(0); } 100% { transform: translateX(100%); } }

header { background: rgba(2, 6, 23, 0.95); backdrop-filter: blur(15px); padding: 10px 20px; position: sticky; top: 0; z-index: 100; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; box-shadow: 0 5px 20px rgba(0,0,0,0.3); }
.brand { font-size: 1.6rem; font-weight: 900; background: linear-gradient(45deg, var(--primary), var(--primary-glow)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; cursor: pointer; letter-spacing: 1px; }
.glow-icons { display: flex; gap: 12px; background: rgba(255, 255, 255, 0.05); padding: 6px 12px; border-radius: 30px; border: 1px solid rgba(255, 255, 255, 0.1); }
.glow-icons a { text-decoration: none; font-size: 1.3rem; transition: transform 0.3s; display:flex; }
.fa-whatsapp { color: #25D366; } .fa-facebook { color: #1877F2; } .fa-instagram { color: #E1306C; }
.glow-icons a:hover { transform: scale(1.2); filter: brightness(1.2); }
.cart-btn { position: relative; color: white; font-size: 1.5rem; cursor: pointer; transition: 0.3s; }
.badge { position: absolute; top: -5px; right: -8px; background: var(--primary); color: black; font-weight: bold; font-size: 0.7rem; padding: 2px 6px; border-radius: 10px; }

.hero { text-align: center; padding: 40px 20px 20px; background: radial-gradient(circle at top, #1e293b 0%, var(--bg-main) 70%); }
.hero h2 { font-size: 2rem; margin: 0 0 10px; color: white; text-shadow: 0 0 20px rgba(255,255,255,0.1); }
.flash-sale-box { background: rgba(255,255,255,0.05); border: 1px solid var(--primary); border-radius: 15px; padding: 15px; margin: 15px auto; display: inline-block; min-width: 200px; }
.flash-title { color: var(--danger); font-weight: bold; margin-bottom: 5px; font-size: 0.9rem; }
.timer-display { font-family: monospace; font-size: 1.5rem; color: white; letter-spacing: 2px; background: #000; padding: 5px 15px; border-radius: 8px; }

.search-container { margin: 20px; position: relative; }
.search-input { width: 100%; padding: 15px 50px 15px 20px; background: var(--bg-surface); border: 1px solid var(--border); border-radius: 30px; color: white; font-size: 1rem; font-family: inherit; transition: 0.3s; }
.search-input:focus { border-color: var(--primary); box-shadow: 0 0 15px rgba(217, 119, 6, 0.2); }
.search-icon { position: absolute; right: 20px; top: 50%; transform: translateY(-50%); color: #64748b; }

.features-bar { display: flex; justify-content: space-around; padding: 15px; margin: 0 15px 20px; background: rgba(255,255,255,0.03); border-radius: 15px; border: 1px solid var(--border); }
.feat-item { text-align: center; font-size: 0.8rem; color: #cbd5e1; }
.feat-item i { color: var(--primary); font-size: 1.2rem; margin-bottom: 5px; display: block; }

.stats-bar { display: flex; justify-content: space-around; margin: 0 20px 30px; padding: 20px; background: var(--bg-surface); border-radius: 20px; border: 1px solid var(--border); text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
.stat-item i { color: var(--primary-glow); font-size: 1.6rem; margin-bottom: 8px; display: block; }
.stat-num { font-size: 1.3rem; font-weight: 800; display: block; color: white; }
.stat-label { font-size: 0.85rem; color: #64748b; }

.nav-scroller { display: flex; gap: 10px; overflow-x: auto; padding: 0 15px 20px; scrollbar-width: none; }
.nav-item { background: var(--bg-surface); color: #94a3b8; border: 1px solid var(--border); padding: 10px 25px; border-radius: 50px; white-space: nowrap; cursor: pointer; transition: 0.3s; font-family: inherit; font-size: 0.95rem; }
.nav-item.active, .nav-item:hover { background: var(--primary); color: black; border-color: var(--primary); font-weight: bold; }

#products { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 20px; padding: 15px; }
.card { background: var(--bg-surface); border-radius: 15px; border: 1px solid var(--border); overflow: hidden; transition: 0.3s; display: flex; flex-direction: column; position: relative; }
.fav-btn { position: absolute; top: 10px; left: 10px; z-index: 5; background: rgba(0,0,0,0.6); color: white; border: none; width: 35px; height: 35px; border-radius: 50%; display: grid; place-items: center; cursor: pointer; transition: 0.3s; }
.fav-btn.active { color: #ef4444; background: white; }
.product-badge { position: absolute; top: 10px; right: 10px; background: var(--primary); color: black; font-size: 0.7rem; padding: 3px 8px; border-radius: 5px; font-weight: bold; z-index: 2; }
.card img { width: 100%; height: 280px; object-fit: contain; background: #fff; padding: 10px; border-bottom: 1px solid var(--border); }
.card-content { padding: 15px; background: linear-gradient(to bottom, var(--bg-surface), #0b1221); }
.cat-tag { font-size: 0.75rem; color: var(--primary-glow); text-transform: uppercase; margin-bottom: 8px; display: block; }
.stock-status { font-size: 0.8rem; font-weight: bold; margin-top: 5px; display: block; }
.stock-normal { color: var(--success); }
.stock-warning { color: var(--danger); animation: pulse-red 1.5s infinite; }
.out-of-stock { color: #94a3b8; text-decoration: line-through; }
@keyframes pulse-red { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }
.price-row { display: flex; justify-content: space-between; align-items: center; margin-top: 15px; }
.price { font-size: 1.3rem; font-weight: bold; color: white; }
.add-btn { background: var(--primary); color: black; border: none; width: 40px; height: 40px; border-radius: 12px; cursor: pointer; display: grid; place-items: center; font-size: 1.2rem; }
.add-btn:disabled { background: #334155; color: #94a3b8; cursor: not-allowed; }

.checkout-box { margin: 30px 15px; padding: 30px 20px; border-radius: 25px; background: #1e293b; border: 1px solid var(--border); }
.custom-input { width: 100%; padding: 15px; background: var(--bg-main); border: 1px solid var(--border); border-radius: 12px; color: white; margin-bottom: 12px; font-family: inherit; font-size: 1rem; }
.btn-main { width: 100%; padding: 16px; border: none; border-radius: 12px; background: linear-gradient(135deg, var(--primary), #b45309); color: white; font-weight: bold; font-size: 1.1rem; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; }
.mini-cart { background: rgba(0,0,0,0.3); padding: 15px; border-radius: 15px; margin-bottom: 20px; border: 1px dashed #475569; }
.cart-item { display: flex; justify-content: space-between; border-bottom: 1px solid rgba(255,255,255,0.1); padding: 10px 0; }

.toast-box { position: fixed; top: 20px; left: 50%; transform: translateX(-50%) translateY(-100px); background: rgba(16, 185, 129, 0.9); color: white; padding: 12px 25px; border-radius: 50px; z-index: 2000; transition: 0.4s; backdrop-filter: blur(5px); display: flex; align-items: center; gap: 10px; }
.toast-box.show { transform: translateX(-50%) translateY(0); }
.notification { position: fixed; bottom: 20px; left: 20px; background: rgba(15, 23, 42, 0.95); border-left: 4px solid var(--success); color: white; padding: 15px; border-radius: 10px; display: flex; align-items: center; gap: 12px; transform: translateX(-150%); transition: 0.5s; z-index: 999; }
.notification.show { transform: translateX(0); }
.notif-icon { width: 40px; height: 40px; background: #1e293b; border-radius: 50%; display: grid; place-items: center; color: var(--success); }

.scroll-top { position: fixed; bottom: 100px; right: 25px; background: var(--bg-surface); color: var(--primary); width: 45px; height: 45px; border-radius: 50%; border: 1px solid var(--border); display: grid; place-items: center; cursor: pointer; opacity: 0; pointer-events: none; transition: 0.3s; z-index: 900; }
.scroll-top.visible { opacity: 1; pointer-events: all; }

footer { text-align: center; padding: 50px 20px; background: #000; margin-top: 50px; border-top: 1px solid var(--border); }
.wa-float { position: fixed; bottom: 25px; right: 25px; background: #25D366; color: white; width: 65px; height: 65px; border-radius: 50%; display: grid; place-items: center; font-size: 32px; box-shadow: 0 0 20px rgba(37,211,102,0.6); z-index: 990; animation: pulse 2s infinite; }
@keyframes pulse { 0%{box-shadow: 0 0 0 0 rgba(37,211,102, 0.7);} 70%{box-shadow: 0 0 0 15px rgba(37,211,102, 0);} 100%{box-shadow: 0 0 0 0 rgba(37,211,102, 0);} }
.developer-credit { margin-top: 20px; padding-top: 15px; border-top: 1px solid rgba(255, 255, 255, 0.1); font-size: 0.95rem; color: #94a3b8; display: flex; flex-direction: column; align-items: center; gap: 8px; }
.dev-name { color: var(--primary-glow); font-weight: 800; text-decoration: none; font-size: 1.1rem; transition: 0.3s; }

.modal { position: fixed; inset: 0; background: rgba(0,0,0,0.95); display: none; place-items: center; z-index: 200; }
.modal-content { background: var(--bg-surface); width: 95%; max-width: 500px; padding: 25px; border-radius: 20px; border: 1px solid var(--border); max-height: 90vh; overflow-y: auto; }
.stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
.stat-box { background: linear-gradient(135deg, #1e293b, #0f172a); padding: 15px; border-radius: 12px; text-align: center; border: 1px solid var(--border); }
.stat-val { font-size: 1.8rem; font-weight: bold; color: var(--primary-glow); display: block; }
.stat-tit { font-size: 0.85rem; color: #94a3b8; }
.revenue { color: var(--success); }

.admin-item { display: flex; justify-content: space-between; align-items: center; background: var(--bg-main); padding: 10px; border-radius: 8px; margin-bottom: 8px; border: 1px solid var(--border); }
.admin-item img { width: 40px; height: 40px; border-radius: 6px; object-fit: cover; }
.qty-input { width: 60px; padding: 5px; background: #020617; border: 1px solid #334155; color: white; text-align: center; border-radius: 5px; }
</style>
</head>
<body>

<div class="splash-screen" id="splash">
    <div class="splash-logo">SHEFO</div>
    <div class="loader-bar"><div class="loader-progress"></div></div>
</div>

<div class="top-ticker">
    <div class="ticker-text" id="tickerText">loading...</div>
</div>

<div class="toast-box" id="toast"><i class="fas fa-check-circle"></i> ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©</div>

<div class="notification" id="notifyBox">
    <div class="notif-icon"><i class="fas fa-check"></i></div>
    <div>
        <div style="font-weight:bold; font-size:0.9rem; color:var(--success)" id="notifyTitle">Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯</div>
        <div style="font-size:0.85rem; color:#cbd5e1" id="notifyMsg">...</div>
    </div>
</div>

<div class="scroll-top" id="scrollTopBtn" onclick="window.scrollTo({top:0, behavior:'smooth'})">
    <i class="fas fa-arrow-up"></i>
</div>

<header>
    <div class="brand" id="secretBtn" onclick="triggerSecret()">SHEFO</div>
    <div class="glow-icons">
        <a href="https://wa.me/201070411245" target="_blank"><i class="fab fa-whatsapp"></i></a>
        <a href="https://www.facebook.com/share/1DYwnY6RxZ/" target="_blank"><i class="fab fa-facebook"></i></a>
        <a href="https://www.instagram.com/shefo_1k" target="_blank"><i class="fab fa-instagram"></i></a>
    </div>
    <div class="cart-btn" onclick="scrollToCheckout()">
        <i class="fas fa-shopping-bag"></i>
        <span class="badge" id="cartCount">0</span>
    </div>
</header>

<div class="hero">
    <h2>âœ¨ SHEFO STORE</h2>
    <p>Ø§Ù„Ø£Ù†Ø§Ù‚Ø©.. ÙÙŠ ÙƒÙ„ ØªÙØµÙŠÙ„Ø©</p>
    
    <div class="flash-sale-box">
        <div class="flash-title">ğŸ”¥ Ø§Ù„Ø¹Ø±Ø¶ ÙŠÙ†ØªÙ‡ÙŠ Ø®Ù„Ø§Ù„:</div>
        <div class="timer-display" id="countdown">--:--:--</div>
    </div>

    <div class="search-container">
        <i class="fas fa-search search-icon"></i>
        <input type="text" id="searchInp" class="search-input" placeholder="Ø¯ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ù„ÙŠ ÙŠØ¹Ø¬Ø¨Ùƒ..." onkeyup="searchProducts()">
    </div>
    
    <div class="features-bar">
        <div class="feat-item"><i class="fas fa-shipping-fast"></i> Ø´Ø­Ù† Ø³Ø±ÙŠØ¹</div>
        <div class="feat-item"><i class="fas fa-hand-holding-usd"></i> Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…</div>
        <div class="feat-item"><i class="fas fa-medal"></i> Ø¶Ù…Ø§Ù† Ø¬ÙˆØ¯Ø©</div>
    </div>
</div>

<div class="stats-bar">
    <div class="stat-item"><i class="fas fa-users"></i><span class="stat-num">+1,500</span><span class="stat-label">Ø¹Ù…ÙŠÙ„</span></div>
    <div class="stat-item"><i class="fas fa-shopping-bag"></i><span class="stat-num">+4,200</span><span class="stat-label">Ø·Ù„Ø¨</span></div>
    <div class="stat-item"><i class="fas fa-star"></i><span class="stat-num">4.9</span><span class="stat-label">ØªÙ‚ÙŠÙŠÙ…</span></div>
</div>

<nav class="nav-scroller">
    <button onclick="renderProd('all', this)" class="nav-item active">Ø§Ù„ÙƒÙ„</button>
    <button onclick="renderProd('Ø³Ø§Ø¹Ø§Øª Ø±Ø¬Ø§Ù„ÙŠ', this)" class="nav-item">Ø³Ø§Ø¹Ø§Øª Ø±Ø¬Ø§Ù„ÙŠ</button>
    <button onclick="renderProd('Ø³Ø§Ø¹Ø§Øª Ø­Ø±ÙŠÙ…ÙŠ', this)" class="nav-item">Ø³Ø§Ø¹Ø§Øª Ø­Ø±ÙŠÙ…ÙŠ</button>
    <button onclick="renderProd('Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª Ø±Ø¬Ø§Ù„ÙŠ', this)" class="nav-item">Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª Ø±Ø¬Ø§Ù„ÙŠ</button>
    <button onclick="renderProd('Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª Ø­Ø±ÙŠÙ…ÙŠ', this)" class="nav-item">Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª Ø­Ø±ÙŠÙ…ÙŠ</button>
    <button onclick="renderProd('Ø´Ø±Ø¨Ø§Øª', this)" class="nav-item">Ø´Ø±Ø¨Ø§Øª</button>
    <button onclick="renderProd('Ø¨ÙˆÙƒØ³Ø±Ø§Øª', this)" class="nav-item">Ø¨ÙˆÙƒØ³Ø±Ø§Øª</button>
    <button onclick="renderProd('Ø¨Ø±ÙØ§Ù† Ø±Ø¬Ø§Ù„ÙŠ', this)" class="nav-item">Ø¨Ø±ÙØ§Ù† Ø±Ø¬Ø§Ù„ÙŠ</button>
    <button onclick="renderProd('Ø¨Ø±ÙØ§Ù† Ø­Ø±ÙŠÙ…ÙŠ', this)" class="nav-item">Ø¨Ø±ÙØ§Ù† Ø­Ø±ÙŠÙ…ÙŠ</button>
    <button onclick="renderProd('ÙƒØ§Ø¨', this)" class="nav-item">ÙƒØ§Ø¨</button>
    <button onclick="renderProd('Ø´Ù†Ø· Ø­Ø±ÙŠÙ…ÙŠ', this)" class="nav-item">Ø´Ù†Ø· Ø­Ø±ÙŠÙ…ÙŠ</button>
    <button onclick="renderProd('Ø£Ø­Ø²Ù…Ø©', this)" class="nav-item">Ø£Ø­Ø²Ù…Ø©</button>
</nav>

<main id="products"></main>

<div class="checkout-box" id="checkoutSection">
    <h3 style="color:var(--primary); margin-bottom:20px"><i class="fas fa-map-marker-alt"></i> Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙˆØµÙŠÙ„</h3>
    <div class="mini-cart">
        <div id="cartEmptyMsg" style="text-align:center; color:#666">Ù„Ù… ØªØ®ØªØ± Ù…Ù†ØªØ¬Ø§Øª Ø¨Ø¹Ø¯</div>
        <div id="cartItems"></div>
        <div style="margin-top:15px; border-top:1px dashed #475569; padding-top:10px; display:flex; justify-content:space-between; font-weight:bold; font-size:1.1rem">
            <span>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</span> <span id="totalPrice" style="color:var(--primary)">0 Ø¬.Ù…</span>
        </div>
        <div id="discountMsg" style="color:var(--success); font-size:0.9rem; margin-top:5px; display:none"></div>
    </div>
    <div style="display:flex; gap:10px; margin-bottom:15px">
        <input id="couponInput" class="custom-input" placeholder="ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ…" style="margin:0">
        <button onclick="applyCoupon()" class="custom-input" style="width:auto; background:var(--success); border:none; cursor:pointer">ØªÙØ¹ÙŠÙ„</button>
    </div>
    <input id="cName" class="custom-input" placeholder="Ø§Ù„Ø§Ø³Ù… Ø¨Ø§Ù„ÙƒØ§Ù…Ù„">
    <input id="cPhone" type="tel" class="custom-input" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„">
    <select id="cCity" class="custom-input">
        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</option>
        <option value="Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©">Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©</option>
        <option value="Ø§Ù„Ø¬ÙŠØ²Ø©">Ø§Ù„Ø¬ÙŠØ²Ø©</option>
        <option value="Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©">Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©</option>
        <option value="Ø§Ù„Ø¯Ù‚Ù‡Ù„ÙŠØ©">Ø§Ù„Ø¯Ù‚Ù‡Ù„ÙŠØ©</option>
        <option value="Ø§Ù„Ø´Ø±Ù‚ÙŠØ©">Ø§Ù„Ø´Ø±Ù‚ÙŠØ©</option>
        <option value="Ø§Ù„Ù…Ù†ÙˆÙÙŠØ©">Ø§Ù„Ù…Ù†ÙˆÙÙŠØ©</option>
        <option value="Ø§Ù„Ù‚Ù„ÙŠÙˆØ¨ÙŠØ©">Ø§Ù„Ù‚Ù„ÙŠÙˆØ¨ÙŠØ©</option>
        <option value="Ø§Ù„Ø¨Ø­ÙŠØ±Ø©">Ø§Ù„Ø¨Ø­ÙŠØ±Ø©</option>
        <option value="Ø§Ù„ØºØ±Ø¨ÙŠØ©">Ø§Ù„ØºØ±Ø¨ÙŠØ©</option>
        <option value="Ø¨ÙˆØ±Ø³Ø¹ÙŠØ¯">Ø¨ÙˆØ±Ø³Ø¹ÙŠØ¯</option>
        <option value="Ø¯Ù…ÙŠØ§Ø·">Ø¯Ù…ÙŠØ§Ø·</option>
        <option value="Ø§Ù„Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„ÙŠØ©">Ø§Ù„Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„ÙŠØ©</option>
        <option value="Ø§Ù„Ø³ÙˆÙŠØ³">Ø§Ù„Ø³ÙˆÙŠØ³</option>
        <option value="ÙƒÙØ± Ø§Ù„Ø´ÙŠØ®">ÙƒÙØ± Ø§Ù„Ø´ÙŠØ®</option>
        <option value="Ø§Ù„ÙÙŠÙˆÙ…">Ø§Ù„ÙÙŠÙˆÙ…</option>
        <option value="Ø¨Ù†ÙŠ Ø³ÙˆÙŠÙ">Ø¨Ù†ÙŠ Ø³ÙˆÙŠÙ</option>
        <option value="Ø§Ù„Ù…Ù†ÙŠØ§">Ø§Ù„Ù…Ù†ÙŠØ§</option>
        <option value="Ø£Ø³ÙŠÙˆØ·">Ø£Ø³ÙŠÙˆØ·</option>
        <option value="Ø³ÙˆÙ‡Ø§Ø¬">Ø³ÙˆÙ‡Ø§Ø¬</option>
        <option value="Ù‚Ù†Ø§">Ù‚Ù†Ø§</option>
        <option value="Ø§Ù„Ø£Ù‚ØµØ±">Ø§Ù„Ø£Ù‚ØµØ±</option>
        <option value="Ø£Ø³ÙˆØ§Ù†">Ø£Ø³ÙˆØ§Ù†</option>
        <option value="Ø§Ù„Ø¨Ø­Ø± Ø§Ù„Ø£Ø­Ù…Ø±">Ø§Ù„Ø¨Ø­Ø± Ø§Ù„Ø£Ø­Ù…Ø±</option>
        <option value="Ø§Ù„ÙˆØ§Ø¯Ù‰ Ø§Ù„Ø¬Ø¯ÙŠØ¯">Ø§Ù„ÙˆØ§Ø¯Ù‰ Ø§Ù„Ø¬Ø¯ÙŠØ¯</option>
        <option value="Ù…Ø·Ø±ÙˆØ­">Ù…Ø·Ø±ÙˆØ­</option>
        <option value="Ø´Ù…Ø§Ù„ Ø³ÙŠÙ†Ø§Ø¡">Ø´Ù…Ø§Ù„ Ø³ÙŠÙ†Ø§Ø¡</option>
        <option value="Ø¬Ù†ÙˆØ¨ Ø³ÙŠÙ†Ø§Ø¡">Ø¬Ù†ÙˆØ¨ Ø³ÙŠÙ†Ø§Ø¡</option>
    </select>
    <input id="cAddress" class="custom-input" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ø§Ù„ØªÙØµÙŠÙ„">
    <button onclick="sendOrder()" class="btn-main"><i class="fab fa-whatsapp"></i> ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨</button>
</div>

<footer>
    <h2 style="margin:0; color:white">SHEFO</h2>
    <p style="margin:5px 0 20px">Ø§Ù„ØªÙ…ÙŠØ² Ø¹Ù†ÙˆØ§Ù†Ù†Ø§</p>
    <div style="margin-top:20px; margin-bottom:20px; font-size:0.8rem">Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù†Ø´Ø± Ù…Ø­ÙÙˆØ¸Ø© Â© 2026</div>
    <div class="developer-credit">
        <div class="dev-info">
            <span class="dev-text">Developed by</span>
            <a href="https://wa.me/201033186744" target="_blank" class="dev-name">Ziad Hany</a>
        </div>
        <div class="dev-icons">
            <a href="https://wa.me/201033186744" target="_blank"><i class="fab fa-whatsapp"></i></a>
            <a href="https://www.facebook.com/share/1ARKH2JF8i/" target="_blank"><i class="fab fa-facebook"></i></a>
        </div>
    </div>
</footer>

<a href="https://wa.me/201070411245" class="wa-float"><i class="fab fa-whatsapp"></i></a>

<div class="modal" id="dashModal">
    <div class="modal-content">
        <h3 style="color:var(--primary); text-align:center">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h3>
        
        <div class="stats-grid">
            <div class="stat-box"><span class="stat-val revenue" id="realRevenue">0 Ø¬.Ù…</span><span class="stat-tit">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</span></div>
            <div class="stat-box" style="border-color:var(--success)"><span class="stat-val" id="netProfit" style="color:var(--success)">0 Ø¬.Ù…</span><span class="stat-tit">ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­ ğŸ’°</span></div>
            <div class="stat-box"><span class="stat-val" id="realOrdersCount">0</span><span class="stat-tit">Ø§Ù„Ø·Ù„Ø¨Ø§Øª</span></div>
            <div class="stat-box"><span class="stat-val" id="productsCount">0</span><span class="stat-tit">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</span></div>
        </div>

        <div style="margin-bottom:15px; border-bottom:1px solid #333; padding-bottom:10px; display:flex; gap:10px; overflow-x:auto">
            <button onclick="toggleTab('prod')" class="btn-main" style="font-size:0.9rem; padding:8px">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</button>
            <button onclick="toggleTab('manual')" class="btn-main" style="font-size:0.9rem; padding:8px; background:var(--primary-glow); color:black">Ø¨ÙŠØ¹Ø© Ø®Ø§Ø±Ø¬ÙŠØ©</button>
            <button onclick="toggleTab('coup')" class="btn-main" style="font-size:0.9rem; padding:8px">Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª</button>
            <button onclick="toggleTab('settings')" class="btn-main" style="font-size:0.9rem; padding:8px">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
        </div>

        <div id="tab-prod">
            <input id="nPName" class="custom-input" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬">
            <label style="color:#888; font-size:0.85rem">ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬:</label>
            <input type="file" id="nPFile" class="custom-input" accept="image/*" style="padding:10px">
            
            <div style="display:flex; gap:10px">
                <input id="nPPrice" type="number" class="custom-input" placeholder="Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹ Ù„Ù„Ø²Ø¨ÙˆÙ†">
                <input id="nPCost" type="number" class="custom-input" placeholder="Ø³Ø¹Ø± Ø§Ù„Ø´Ø±Ø§Ø¡ (Ø§Ù„ØªÙƒÙ„ÙØ©)" style="border-color:var(--success)">
            </div>
            
            <input id="nPQty" type="number" class="custom-input" placeholder="Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…ØªØ§Ø­Ø©">
            <select id="nPCat" class="custom-input">
                <option value="Ø³Ø§Ø¹Ø§Øª Ø±Ø¬Ø§Ù„ÙŠ">Ø³Ø§Ø¹Ø§Øª Ø±Ø¬Ø§Ù„ÙŠ</option>
                <option value="Ø³Ø§Ø¹Ø§Øª Ø­Ø±ÙŠÙ…ÙŠ">Ø³Ø§Ø¹Ø§Øª Ø­Ø±ÙŠÙ…ÙŠ</option>
                <option value="Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª Ø±Ø¬Ø§Ù„ÙŠ">Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª Ø±Ø¬Ø§Ù„ÙŠ</option>
                <option value="Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª Ø­Ø±ÙŠÙ…ÙŠ">Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª Ø­Ø±ÙŠÙ…ÙŠ</option>
                <option value="Ø´Ø±Ø¨Ø§Øª">Ø´Ø±Ø¨Ø§Øª</option>
                <option value="Ø¨ÙˆÙƒØ³Ø±Ø§Øª">Ø¨ÙˆÙƒØ³Ø±Ø§Øª</option>
                <option value="Ø¨Ø±ÙØ§Ù† Ø±Ø¬Ø§Ù„ÙŠ">Ø¨Ø±ÙØ§Ù† Ø±Ø¬Ø§Ù„ÙŠ</option>
                <option value="Ø¨Ø±ÙØ§Ù† Ø­Ø±ÙŠÙ…ÙŠ">Ø¨Ø±ÙØ§Ù† Ø­Ø±ÙŠÙ…ÙŠ</option>
                <option value="ÙƒØ§Ø¨">ÙƒØ§Ø¨</option>
                <option value="Ø´Ù†Ø· Ø­Ø±ÙŠÙ…ÙŠ">Ø´Ù†Ø· Ø­Ø±ÙŠÙ…ÙŠ</option>
                <option value="Ø£Ø­Ø²Ù…Ø©">Ø£Ø­Ø²Ù…Ø©</option>
            </select>
            <button onclick="addProduct()" class="btn-main" style="background:var(--success)">Ù†Ø´Ø± Ø§Ù„Ù…Ù†ØªØ¬</button>
            <div id="adminList" style="margin-top:15px; border-top:1px solid #333; padding-top:10px"></div>
        </div>

        <div id="tab-manual" style="display:none; text-align:center">
            <h4 style="color:var(--primary-glow)">ØªØ³Ø¬ÙŠÙ„ Ø¨ÙŠØ¹Ø© ØªÙ…Øª Ø®Ø§Ø±Ø¬ Ø§Ù„Ù…ÙˆÙ‚Ø¹</h4>
            <input id="mDesc" class="custom-input" placeholder="ØªÙØ§ØµÙŠÙ„ (Ù…Ø«Ø§Ù„: Ø³Ø§Ø¹Ø© Ù„ØµØ§Ø­Ø¨ÙŠ)">
            <input id="mPrice" type="number" class="custom-input" placeholder="Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù„ÙŠ Ø§Ø³ØªÙ„Ù…ØªÙ‡ (Ø¨ÙŠØ¹)">
            <input id="mCost" type="number" class="custom-input" placeholder="Ø§Ù„Ø­Ø§Ø¬Ø© Ø¯ÙŠ ÙˆÙ‚ÙØª Ø¹Ù„ÙŠÙƒ Ø¨ÙƒØ§Ù…ØŸ (ØªÙƒÙ„ÙØ©)">
            <button onclick="addManualOrder()" class="btn-main" style="background:var(--success)">ØªØ³Ø¬ÙŠÙ„ ÙÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ ğŸ’°</button>
        </div>

        <div id="tab-coup" style="display:none">
            <input id="nCCode" class="custom-input" placeholder="Ø§Ù„ÙƒÙˆØ¯ (Ù…Ø«Ø§Ù„: SAVE10)">
            <input id="nCVal" type="number" class="custom-input" placeholder="Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®ØµÙ…">
            <button onclick="saveCoupon()" class="btn-main">Ø­ÙØ¸</button>
            <p style="margin-top:10px">Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ: <span id="currCoup" style="color:var(--primary)">--</span></p>
        </div>

        <div id="tab-settings" style="display:none">
            <label style="color:white; font-size:0.9rem">Ù†Øµ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ù…ØªØ­Ø±Ùƒ:</label>
            <input id="nTicker" class="custom-input" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ù†Øµ Ù‡Ù†Ø§...">
            <label style="color:white; font-size:0.9rem">Ù…Ø¯Ø© Ø§Ù„Ø¹Ø±Ø¶ (Ø¨Ø§Ù„Ø³Ø§Ø¹Ø§Øª):</label>
            <input id="nTimer" type="number" class="custom-input" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª">
            <button onclick="saveSettings()" class="btn-main" style="background:var(--success)">Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
        </div>

        <button onclick="document.getElementById('dashModal').style.display='none'" style="width:100%; margin-top:15px; background:#ef4444; border:none; padding:12px; color:white; cursor:pointer; border-radius:10px">Ø®Ø±ÙˆØ¬</button>
    </div>
</div>

<div class="modal" id="passModal">
    <div class="modal-content" style="text-align:center">
        <h3>ğŸ” ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</h3>
        <input type="password" id="passInp" class="custom-input">
        <button onclick="login()" class="btn-main">Ø¯Ø®ÙˆÙ„</button>
        <button onclick="document.getElementById('passModal').style.display='none'" style="margin-top:10px; background:transparent; border:none; color:red; cursor:pointer">Ø¥Ù„ØºØ§Ø¡</button>
    </div>
</div>

<script type="module">
    // ---------------------- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙØ§ÙŠØ±Ø¨ÙŠØ² ----------------------
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs, doc, deleteDoc, updateDoc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCdsXCuOtmne7g5oytUtOTZpOFgNEcoChA",
      authDomain: "shefo-store-e21df.firebaseapp.com",
      projectId: "shefo-store-e21df",
      storageBucket: "shefo-store-e21df.firebasestorage.app",
      messagingSenderId: "115869788089",
      appId: "1:115869788089:web:dee7128b974d310abab868"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const productsColl = collection(db, "products");
    const settingsDoc = doc(db, "settings", "mainConfig");
    const couponDoc = doc(db, "settings", "couponConfig");
    const ordersColl = collection(db, "orders");

    // ---------------------- Ù…ØªØºÙŠØ±Ø§Øª Ø¹Ø§Ù…Ø© ----------------------
    let products = [];
    let cart = [];
    let coupon = {code:"", val:0};
    let config = { ticker: "Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø´ÙŠÙÙˆ Ø³ØªÙˆØ±", timerHours: 4 };
    let timerInterval;

    // ---------------------- Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© (Firebase) ----------------------
    async function fetchData() {
        const pSnap = await getDocs(productsColl);
        products = [];
        pSnap.forEach(d => products.push({id: d.id, ...d.data()}));
        try {
            const sSnap = await getDoc(settingsDoc);
            if(sSnap.exists()) config = sSnap.data();
            applyConfig();
        } catch(e) {}
        try {
            const cSnap = await getDoc(couponDoc);
            if(cSnap.exists()) coupon = cSnap.data();
            updateCoupDisplay();
        } catch(e) {}
        renderProd('all', document.querySelector('.nav-item'));
    }

    // ---------------------- Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¹Ø±Ø¶ ÙˆØ§Ù„ØªØ¹Ø§Ù…Ù„ ----------------------
    window.onload = () => {
        setTimeout(() => { document.getElementById('splash').style.opacity='0'; setTimeout(()=>document.getElementById('splash').style.display='none',500); }, 2000);
        fetchData(); 
        startNotifications();
        window.onscroll = () => {
            if(window.scrollY > 300) document.getElementById('scrollTopBtn').classList.add('visible');
            else document.getElementById('scrollTopBtn').classList.remove('visible');
        };
    };

    function applyConfig() {
        document.getElementById('tickerText').innerText = config.ticker || "Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ";
        if(timerInterval) clearInterval(timerInterval);
        let duration = (config.timerHours || 4) * 60 * 60;
        timerInterval = setInterval(function () {
            let hours = Math.floor(duration / 3600);
            let minutes = Math.floor((duration % 3600) / 60);
            let seconds = duration % 60;
            document.getElementById('countdown').innerText = 
                `${hours < 10 ? "0" + hours : hours}:${minutes < 10 ? "0" + minutes : minutes}:${seconds < 10 ? "0" + seconds : seconds}`;
            if (--duration < 0) duration = (config.timerHours||4) * 60 * 60;
        }, 1000);
    }

    window.renderProd = (cat, btn) => {
        if(btn) { document.querySelectorAll('.nav-item').forEach(b=>b.classList.remove('active')); btn.classList.add('active'); }
        const div = document.getElementById('products'); div.innerHTML="";
        let found=false;
        products.forEach((p,i) => {
            if(cat==='all' || p.cat===cat) {
                found=true;
                createCard(p, i, div);
            }
        });
        if(!found) div.innerHTML = "<p style='grid-column:1/-1;text-align:center;color:#64748b;padding:20px'>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª</p>";
    };

    window.searchProducts = () => {
        let term = document.getElementById('searchInp').value.toLowerCase();
        const div = document.getElementById('products'); div.innerHTML="";
        products.forEach((p,i) => {
            if(p.name.toLowerCase().includes(term)) createCard(p, i, div);
        });
    };

    function createCard(p, i, container) {
        let stockHtml = '';
        let btnDisabled = '';
        let currentQty = (p.qty !== undefined) ? parseInt(p.qty) : 0;
        
        if(currentQty <= 0) {
            stockHtml = '<span class="stock-status out-of-stock">Ù†ÙØ¯Øª Ø§Ù„ÙƒÙ…ÙŠØ© âŒ</span>';
            btnDisabled = 'disabled';
        } else if (currentQty <= 2) {
            stockHtml = `<span class="stock-status stock-warning">ğŸ”¥ Ù…ØªØ¨Ù‚ÙŠ ${currentQty} ÙÙ‚Ø·!</span>`;
        } else {
            stockHtml = `<span class="stock-status stock-normal">Ù…ØªØ§Ø­: ${currentQty} Ù‚Ø·Ø¹Ø©</span>`;
        }
        
        container.innerHTML += `
        <div class="card">
            <button class="fav-btn" onclick="this.classList.toggle('active')"><i class="fas fa-heart"></i></button>
            <div class="product-badge">Ø¬Ø¯ÙŠØ¯</div>
            <img src="${p.img}">
            <div class="card-content">
                <span class="cat-tag">${p.cat}</span>
                <h4>${p.name}</h4>
                ${stockHtml}
                <div class="price-row">
                    <span class="price">${p.price} Ø¬.Ù…</span>
                    <button class="add-btn" ${btnDisabled} onclick="add('${p.id}')"><i class="fas fa-plus"></i></button>
                </div>
            </div>
        </div>`;
    }

    window.add = (id) => {
        let product = products.find(p => p.id === id);
        if(product) {
            cart.push(product);
            document.getElementById('cartCount').innerText = cart.length;
            let toast = document.getElementById('toast');
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2500);
            renderCart();
        }
    };

    window.renderCart = () => {
        const div = document.getElementById('cartItems');
        if(cart.length===0) { div.innerHTML=""; document.getElementById('cartEmptyMsg').style.display='block'; document.getElementById('totalPrice').innerText="0 Ø¬.Ù…"; return 0; }
        document.getElementById('cartEmptyMsg').style.display='none';
        div.innerHTML="";
        let total = 0;
        cart.forEach((p,i) => {
            total+=parseInt(p.price);
            div.innerHTML+=`<div class="cart-item"><span>${p.name}</span><div><span>${p.price}</span> <span onclick="rem(${i})" style="color:red;cursor:pointer;margin-right:8px"><i class="fas fa-times"></i></span></div></div>`;
        });
        let disc = 0;
        let inp = document.getElementById('couponInput').value;
        if(inp && inp === coupon.code) {
            disc = parseInt(coupon.val);
            document.getElementById('discountMsg').style.display='block';
            document.getElementById('discountMsg').innerText = `Ø®ØµÙ… Ù…ÙØ¹Ù„: -${disc} Ø¬.Ù…`;
        } else { document.getElementById('discountMsg').style.display='none'; }
        let final = Math.max(0, total - disc);
        document.getElementById('totalPrice').innerText = final + " Ø¬.Ù…";
        return final;
    };

    window.rem = (i) => { cart.splice(i,1); document.getElementById('cartCount').innerText=cart.length; renderCart(); };
    window.applyCoupon = () => { renderCart(); alert("ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙƒÙˆØ¯ Ø¥Ù† ÙˆØ¬Ø¯"); };

    window.sendOrder = async () => {
        if(cart.length===0) return alert("Ø§Ø®ØªØ± Ù…Ù†ØªØ¬Ø§Øª Ø£ÙˆÙ„Ø§Ù‹");
        let name = document.getElementById('cName').value;
        let phone = document.getElementById('cPhone').value;
        let city = document.getElementById('cCity').value;
        let addr = document.getElementById('cAddress').value;
        if(!name || !phone || !city) return alert("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
        
        let total = renderCart();
        // Ø­Ø³Ø§Ø¨ Ø§Ù„ØªÙƒÙ„ÙØ© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© Ù„Ù„Ø£ÙˆØ±Ø¯Ø± Ø¹Ø´Ø§Ù† Ù†Ø¹Ø±Ù Ø§Ù„Ù…ÙƒØ³Ø¨
        let totalCost = cart.reduce((sum, p) => sum + (parseInt(p.costPrice) || 0), 0);
        
        await addDoc(ordersColl, {
            date: new Date().toISOString(),
            total: total,
            totalCost: totalCost, // ØªØ®Ø²ÙŠÙ† Ø§Ù„ØªÙƒÙ„ÙØ©
            itemsCount: cart.length
        });

        let items = cart.map(p=>`â–ªï¸ ${p.name}`).join("%0a");
        let msg = `*Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯* ğŸ›ï¸%0ağŸ‘¤ ${name}%0ağŸ“± ${phone}%0ağŸ™ï¸ ${city} - ${addr}%0a----------------%0a${items}%0a----------------%0ağŸ’° *Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${total} Ø¬.Ù…*`;
        window.open(`https://wa.me/201070411245?text=${msg}`);
        cart=[]; document.getElementById('cartCount').innerText=0; renderCart();
    };

    window.scrollToCheckout = () => { document.getElementById('checkoutSection').scrollIntoView({behavior:'smooth'}); };

    function startNotifications() {
        setInterval(() => {
            if(document.hidden) return;
            if(products.length === 0) return;
            let name = ["Ø£Ø­Ù…Ø¯","Ù…Ø­Ù…Ø¯","Ù…Ø­Ù…ÙˆØ¯","Ø¹Ù„ÙŠ","Ø³Ø§Ø±Ø©","ÙŠØ§Ø³Ù…ÙŠÙ†"][Math.floor(Math.random()*6)];
            let city = ["Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©","Ø§Ù„Ø¬ÙŠØ²Ø©","Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©"][Math.floor(Math.random()*3)];
            let prod = products[Math.floor(Math.random()*products.length)].name;
            document.getElementById('notifyMsg').innerText = `${name} Ù…Ù† ${city} Ø·Ù„Ø¨ ${prod}`;
            let box = document.getElementById('notifyBox'); box.classList.add('show');
            setTimeout(() => box.classList.remove('show'), 5000);
        }, 20000);
    }

    let clicks = 0;
    window.triggerSecret = () => { 
        clearTimeout(window.tm); clicks++; 
        if(clicks===5){document.getElementById('passModal').style.display='grid'; clicks=0;} 
        window.tm=setTimeout(()=>clicks=0,1000); 
    };

    // âœ¨âœ¨âœ¨ Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø¯Ù„Ø©: Ø­Ø³Ø§Ø¨ ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­ âœ¨âœ¨âœ¨
    window.login = async () => {
        if(document.getElementById('passInp').value==="ziad1234") {
            document.getElementById('passModal').style.display='none';
            document.getElementById('dashModal').style.display='grid';
            
            // ØªØµÙÙŠØ± Ù…Ø¨Ø¯Ø¦ÙŠ
            document.getElementById('realOrdersCount').innerText = "0";
            document.getElementById('realRevenue').innerText = "0 Ø¬.Ù…";
            document.getElementById('netProfit').innerText = "0 Ø¬.Ù…";
            document.getElementById('productsCount').innerText = products.length;

            try {
                const ordersSnap = await getDocs(ordersColl);
                if (!ordersSnap.empty) {
                    document.getElementById('realOrdersCount').innerText = ordersSnap.size;
                    let totalRev = 0;
                    let totalCost = 0;
                    
                    ordersSnap.forEach(doc => {
                        const data = doc.data();
                        totalRev += (data.total || 0);
                        totalCost += (data.totalCost || 0);
                    });
                    
                    document.getElementById('realRevenue').innerText = totalRev + " Ø¬.Ù…";
                    // ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­ = Ø§Ù„Ø¨ÙŠØ¹ - Ø§Ù„Ø´Ø±Ø§Ø¡
                    document.getElementById('netProfit').innerText = (totalRev - totalCost) + " Ø¬.Ù…";
                }
            } catch(e) { console.log("Ù„Ø³Ù‡ Ù…ÙÙŠØ´ Ø·Ù„Ø¨Ø§Øª"); }
            
            renderAdmin();
        } else alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨Ø§Ø³ÙˆØ±Ø¯");
    };

    window.toggleTab = (t) => {
        ['prod','manual','coup','settings'].forEach(x => document.getElementById('tab-'+x).style.display='none');
        document.getElementById('tab-'+t).style.display='block';
    };

    // âœ¨âœ¨âœ¨ Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ ÙŠØ¯ÙˆÙŠ Ø¨Ø§Ù„ØªÙƒÙ„ÙØ© âœ¨âœ¨âœ¨
    window.addManualOrder = async () => {
        let desc = document.getElementById('mDesc').value;
        let price = document.getElementById('mPrice').value;
        let cost = document.getElementById('mCost').value;
        
        if(!price) return alert("Ù„Ø§Ø²Ù… ØªÙƒØªØ¨ Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹!");

        if(confirm(`ØªØ³Ø¬ÙŠÙ„ Ø¨ÙŠØ¹Ø© Ø¨Ù€ ${price} Ø¬Ù†ÙŠÙ‡ØŸ`)) {
            try {
                await addDoc(ordersColl, {
                    date: new Date().toISOString(),
                    total: parseInt(price),
                    totalCost: parseInt(cost) || 0, // Ø¨Ù†Ø­ÙØ¸ Ø§Ù„ØªÙƒÙ„ÙØ© ÙƒÙ…Ø§Ù†
                    itemsCount: 1,
                    note: desc || "Ø¨ÙŠØ¹Ø© Ø®Ø§Ø±Ø¬ÙŠØ© (ÙŠØ¯ÙˆÙŠ)"
                });
                alert("ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„! ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­ Ù‡ÙŠØªØ­Ø¯Ø« Ø¯Ù„ÙˆÙ‚ØªÙŠ ğŸ’°");
                document.getElementById('mDesc').value = "";
                document.getElementById('mPrice').value = "";
                document.getElementById('mCost').value = "";
                window.login(); 
            } catch(e) {
                alert("Ø­ØµÙ„ Ø®Ø·Ø£");
            }
        }
    };

    // âœ¨âœ¨âœ¨ Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ù…Ø¹ Ø­ÙØ¸ Ø§Ù„ØªÙƒÙ„ÙØ© (Ø³Ø±ÙŠ) âœ¨âœ¨âœ¨
    window.addProduct = async () => {
        let name = document.getElementById('nPName').value;
        let price = document.getElementById('nPPrice').value;
        let cost = document.getElementById('nPCost').value; // Ø³Ø¹Ø± Ø§Ù„ØªÙƒÙ„ÙØ©
        let cat = document.getElementById('nPCat').value;
        let qty = document.getElementById('nPQty').value;
        let fileInput = document.getElementById('nPFile');

        if(!name || !price || !qty) return alert("Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
        
        let btn = document.querySelector('button[onclick="addProduct()"]');
        let oldText = btn.innerText;
        btn.innerText = "ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© ÙˆØ§Ù„Ø±ÙØ¹...";
        btn.disabled = true;

        const upload = async (finalImg) => {
            try {
                if(finalImg.length > 1048487) {
                    alert("Ø§Ù„ØµÙˆØ±Ø© Ø¯ÙŠ Ø¶Ø®Ù…Ø© Ø¬Ø¯Ø§Ù‹! Ø¬Ø±Ø¨ ØµÙˆØ±Ø© ØºÙŠØ±Ù‡Ø§.");
                    btn.innerText = oldText;
                    btn.disabled = false;
                    return;
                }
                
                await addDoc(productsColl, {
                    name, price, cat, qty, img:finalImg,
                    costPrice: cost || 0 // Ø­ÙØ¸ Ø§Ù„ØªÙƒÙ„ÙØ© ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                });
                
                alert("ØªÙ… Ø§Ù„Ù†Ø´Ø± Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰");
                document.getElementById('nPName').value = "";
                document.getElementById('nPPrice').value = "";
                document.getElementById('nPCost').value = "";
                document.getElementById('nPQty').value = "";
                fileInput.value = "";
                fetchData();
                renderAdmin();
            } catch(e) {
                console.error(e);
                alert("Ø®Ø·Ø£: " + e.message);
            }
            btn.innerText = oldText;
            btn.disabled = false;
        };

        if(fileInput.files[0]) {
            let reader = new FileReader();
            reader.onload = function(e) {
                let img = new Image();
                img.onload = function() {
                    let canvas = document.createElement('canvas');
                    let ctx = canvas.getContext('2d');
                    
                    let maxWidth = 500;
                    let maxHeight = 500;
                    let width = img.width;
                    let height = img.height;

                    if (width > height) {
                        if (width > maxWidth) { height *= maxWidth / width; width = maxWidth; }
                    } else {
                        if (height > maxHeight) { width *= maxHeight / height; height = maxHeight; }
                    }

                    canvas.width = width;
                    canvas.height = height;
                    ctx.drawImage(img, 0, 0, width, height);
                    
                    let quality = 0.7;
                    let dataUrl = canvas.toDataURL('image/jpeg', quality);

                    while(dataUrl.length > 800000 && quality > 0.1) {
                        quality -= 0.1;
                        dataUrl = canvas.toDataURL('image/jpeg', quality);
                    }
                    upload(dataUrl);
                }
                img.src = e.target.result;
            }
            reader.readAsDataURL(fileInput.files[0]);
        } else {
            upload("https://via.placeholder.com/300?text=SHEFO");
        }
    };

    window.renderAdmin = () => {
        let d = document.getElementById('adminList'); d.innerHTML="";
        products.forEach((p,i)=>d.innerHTML+=`
        <div class="admin-item">
            <div style="display:flex; align-items:center; gap:10px">
                <img src="${p.img}">
                <span>${p.name}</span>
            </div>
            <div style="display:flex; align-items:center; gap:5px">
                <input type="number" class="qty-input" value="${p.qty}" onchange="updateQty('${p.id}', this.value)">
                <button onclick="del('${p.id}')" style="color:red;border:none;background:none;cursor:pointer"><i class="fas fa-trash"></i></button>
            </div>
        </div>`);
    };

    window.updateQty = async (id, newQty) => {
        await updateDoc(doc(db, "products", id), { qty: newQty });
        fetchData();
    };

    window.del = async (id) => {
        if(confirm("Ù…Ø³Ø­ Ø§Ù„Ù…Ù†ØªØ¬ØŸ")) {
            await deleteDoc(doc(db, "products", id));
            fetchData();
            setTimeout(renderAdmin, 500);
        }
    };

    window.saveCoupon = async () => { 
        let cCode = document.getElementById('nCCode').value;
        let cVal = document.getElementById('nCVal').value;
        await setDoc(couponDoc, {code: cCode, val: cVal});
        coupon = {code: cCode, val: cVal};
        updateCoupDisplay();
        alert("ØªÙ… Ø§Ù„Ø­ÙØ¸"); 
    };

    function updateCoupDisplay() { document.getElementById('currCoup').innerText = coupon.code || "Ù„Ø§ ÙŠÙˆØ¬Ø¯"; }

    window.saveSettings = async () => {
        let t = document.getElementById('nTicker').value;
        let h = document.getElementById('nTimer').value;
        await setDoc(settingsDoc, { 
            ticker: t || config.ticker, 
            timerHours: h || config.timerHours 
        });
        alert("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ«Ù‡Ø§ Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡ âœ…");
        location.reload();
    };

</script>
</body>
</html>

